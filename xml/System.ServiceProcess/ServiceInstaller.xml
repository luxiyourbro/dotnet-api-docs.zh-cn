<Type Name="ServiceInstaller" FullName="System.ServiceProcess.ServiceInstaller">
  <Metadata>
    <Meta Name="ms.openlocfilehash" Value="3b38ce9c25d631c2dde01d2084bafbb98967c9b5" />
    <Meta Name="ms.sourcegitcommit" Value="6a0b904069161bbaec4ffd02aa7d9cf38c61e72e" />
    <Meta Name="ms.translationtype" Value="HT" />
    <Meta Name="ms.contentlocale" Value="zh-CN" />
    <Meta Name="ms.lasthandoff" Value="06/24/2018" />
    <Meta Name="ms.locfileid" Value="36410105" />
  </Metadata>
  <TypeSignature Language="C#" Value="public class ServiceInstaller : System.Configuration.Install.ComponentInstaller" />
  <TypeSignature Language="ILAsm" Value=".class public auto ansi beforefieldinit ServiceInstaller extends System.Configuration.Install.ComponentInstaller" />
  <TypeSignature Language="DocId" Value="T:System.ServiceProcess.ServiceInstaller" />
  <TypeSignature Language="VB.NET" Value="Public Class ServiceInstaller&#xA;Inherits ComponentInstaller" />
  <TypeSignature Language="C++ CLI" Value="public ref class ServiceInstaller : System::Configuration::Install::ComponentInstaller" />
  <TypeSignature Language="F#" Value="type ServiceInstaller = class&#xA;    inherit ComponentInstaller" />
  <AssemblyInfo>
    <AssemblyName>System.ServiceProcess</AssemblyName>
    <AssemblyVersion>4.0.0.0</AssemblyVersion>
  </AssemblyInfo>
  <Base>
    <BaseTypeName>System.Configuration.Install.ComponentInstaller</BaseTypeName>
  </Base>
  <Interfaces />
  <Docs>
    <summary>
      <span data-ttu-id="0ebb9-101">Installs a class that extends <see cref="T:System.ServiceProcess.ServiceBase" /> to implement a service.</span>
      <span class="sxs-lookup">
        <span data-stu-id="0ebb9-101">Installs a class that extends <see cref="T:System.ServiceProcess.ServiceBase" /> to implement a service.</span>
      </span>
      <span data-ttu-id="0ebb9-102">This class is called by the install utility when installing a service application.</span>
      <span class="sxs-lookup">
        <span data-stu-id="0ebb9-102">This class is called by the install utility when installing a service application.</span>
      </span>
    </summary>
    <remarks>
      <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="0ebb9-103"><xref:System.ServiceProcess.ServiceInstaller>功能正常运行特定于其关联的服务。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-103">The <xref:System.ServiceProcess.ServiceInstaller> does work specific to the service with which it is associated.</span></span> <span data-ttu-id="0ebb9-104">安装实用程序使用它来写入与 HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services 注册表项中的子项的服务关联的注册表值。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-104">It is used by the installation utility to write registry values associated with the service to a subkey within the HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services registry key.</span></span> <span data-ttu-id="0ebb9-105">此子项中其 ServiceName 由标识服务。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-105">The service is identified by its ServiceName within this subkey.</span></span> <span data-ttu-id="0ebb9-106">子项还包括可执行文件或与该服务所属的.dll 的名称。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-106">The subkey also includes the name of the executable or .dll to which the service belongs.</span></span>  
  
 <span data-ttu-id="0ebb9-107">若要安装服务，创建继承自项目安装程序类<xref:System.Configuration.Install.Installer>类，并将设置<xref:System.ComponentModel.RunInstallerAttribute>到类中的属性`true`。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-107">To install a service, create a project installer class that inherits from the <xref:System.Configuration.Install.Installer> class, and set the <xref:System.ComponentModel.RunInstallerAttribute> attribute on the class to `true`.</span></span> <span data-ttu-id="0ebb9-108">在项目中，创建一个<xref:System.ServiceProcess.ServiceProcessInstaller>每个服务应用程序，另一个实例<xref:System.ServiceProcess.ServiceInstaller>应用程序中每个服务的实例。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-108">Within your project, create one <xref:System.ServiceProcess.ServiceProcessInstaller> instance per service application, and one <xref:System.ServiceProcess.ServiceInstaller> instance for each service in the application.</span></span> <span data-ttu-id="0ebb9-109">在您项目安装程序类的构造函数，将设置为服务使用的安装属性<xref:System.ServiceProcess.ServiceProcessInstaller>和<xref:System.ServiceProcess.ServiceInstaller>实例，并将实例添加到<xref:System.Configuration.Install.Installer.Installers%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-109">Within your project installer class constructor, set the installation properties for the service using the <xref:System.ServiceProcess.ServiceProcessInstaller> and <xref:System.ServiceProcess.ServiceInstaller> instances, and add the instances to the <xref:System.Configuration.Install.Installer.Installers%2A> collection.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="0ebb9-110">建议添加安装程序实例; 使用构造函数但是，如果你需要将添加到<xref:System.Configuration.Install.Installer.Installers%2A>中的集合<xref:System.ServiceProcess.ServiceInstaller.Install%2A>方法，请务必执行上述相同的元素添加到集合中<xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-110">It is recommended that you use the constructor for adding installer instances; however, if you need to add to the <xref:System.Configuration.Install.Installer.Installers%2A> collection in the <xref:System.ServiceProcess.ServiceInstaller.Install%2A> method, be sure to perform the same additions to the collection in the <xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A> method.</span></span>  
  
 <span data-ttu-id="0ebb9-111">为派生自的所有类<xref:System.Configuration.Install.Installer>类的状态<xref:System.Configuration.Install.Installer.Installers%2A>集合必须在相同<xref:System.ServiceProcess.ServiceInstaller.Install%2A>和<xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-111">For all classes deriving from the <xref:System.Configuration.Install.Installer> class, the state of the <xref:System.Configuration.Install.Installer.Installers%2A> collection must be the same in the <xref:System.ServiceProcess.ServiceInstaller.Install%2A> and <xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A> methods.</span></span> <span data-ttu-id="0ebb9-112">但是，您可以避免在对集合进行维护<xref:System.ServiceProcess.ServiceInstaller.Install%2A>和<xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A>方法如果你安装程序将实例添加到<xref:System.Configuration.Install.Installer.Installers%2A>在自定义安装程序类构造函数的集合。当调用安装实用工具时，它会查找<xref:System.ComponentModel.RunInstallerAttribute>属性。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-112">However, you can avoid the maintenance of the collection across the <xref:System.ServiceProcess.ServiceInstaller.Install%2A> and <xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A> methods if you add installer instances to the <xref:System.Configuration.Install.Installer.Installers%2A> collection in your custom installer class constructor.When the install utility is called, it looks for the <xref:System.ComponentModel.RunInstallerAttribute> attribute.</span></span> <span data-ttu-id="0ebb9-113">如果属性是`true`，安装已添加到的所有服务，该实用程序<xref:System.Configuration.Install.Installer.Installers%2A>与项目安装程序相关联的集合。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-113">If the attribute is `true`, the utility installs all the services that were added to the <xref:System.Configuration.Install.Installer.Installers%2A> collection that were associated with your project installer.</span></span> <span data-ttu-id="0ebb9-114">如果<xref:System.ComponentModel.RunInstallerAttribute>是`false`或不存在，则安装实用工具忽略项目安装程序。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-114">If <xref:System.ComponentModel.RunInstallerAttribute> is `false` or does not exist, the install utility ignores the project installer.</span></span>  
  
 <span data-ttu-id="0ebb9-115"><xref:System.ServiceProcess.ServiceProcessInstaller>与项目安装类安装信息普遍适用于所有关联<xref:System.ServiceProcess.ServiceInstaller>项目中的实例。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-115">The <xref:System.ServiceProcess.ServiceProcessInstaller> associated with your project installation class installs information common to all <xref:System.ServiceProcess.ServiceInstaller> instances in the project.</span></span> <span data-ttu-id="0ebb9-116">如果此服务已将它隔离从安装项目中的其他服务的任何内容，此方法被安装该特定于服务的信息。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-116">If this service has anything that separates it from the other services in the installation project, that service-specific information is installed by this method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="0ebb9-117">至关重要的<xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A>能与<xref:System.ServiceProcess.ServiceBase.ServiceName%2A?displayProperty=nameWithType>类派生自的<xref:System.ServiceProcess.ServiceBase>。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-117">It is crucial that the <xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A> be identical to the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A?displayProperty=nameWithType> of the class you derived from <xref:System.ServiceProcess.ServiceBase>.</span></span> <span data-ttu-id="0ebb9-118">通常情况下，值<xref:System.ServiceProcess.ServiceBase.ServiceName%2A?displayProperty=nameWithType>在服务应用程序的可执行文件的 main （） 函数中设置服务的属性。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-118">Normally, the value of the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A?displayProperty=nameWithType> property for the service is set within the Main() function of the service application's executable.</span></span> <span data-ttu-id="0ebb9-119">服务控制管理器使用<xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A?displayProperty=nameWithType>属性可以查找服务在服务内此可执行文件。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-119">The Service Control Manager uses the <xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A?displayProperty=nameWithType> property to locate the service within this executable.</span></span>  
  
 <span data-ttu-id="0ebb9-120">你可以修改其他属性上<xref:System.ServiceProcess.ServiceInstaller>之前或之后将其添加到<xref:System.Configuration.Install.Installer.Installers%2A>项目安装程序的集合。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-120">You can modify other properties on the <xref:System.ServiceProcess.ServiceInstaller> either before or after adding it to the <xref:System.Configuration.Install.Installer.Installers%2A> collection of your project installer.</span></span> <span data-ttu-id="0ebb9-121">例如，服务的<xref:System.ServiceProcess.ServiceInstaller.StartType%2A>可能设置为启动自动在重新启动服务或要求用户手动启动此服务。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-121">For example, a service's <xref:System.ServiceProcess.ServiceInstaller.StartType%2A> may be set to start the service automatically at reboot or require a user to start the service manually.</span></span>  
  
 <span data-ttu-id="0ebb9-122">通常情况下，你将不调用对象方法<xref:System.ServiceProcess.ServiceInstaller>在代码中; 它们是通常只能由调用安装实用程序。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-122">Normally, you will not call the methods on <xref:System.ServiceProcess.ServiceInstaller> within your code; they are generally called only by the install utility.</span></span> <span data-ttu-id="0ebb9-123">安装实用程序将自动调用<xref:System.ServiceProcess.ServiceProcessInstaller.Install%2A?displayProperty=nameWithType>和<xref:System.ServiceProcess.ServiceInstaller.Install%2A?displayProperty=nameWithType>在安装过程中的方法。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-123">The install utility automatically calls the <xref:System.ServiceProcess.ServiceProcessInstaller.Install%2A?displayProperty=nameWithType> and <xref:System.ServiceProcess.ServiceInstaller.Install%2A?displayProperty=nameWithType> methods during the installation process.</span></span> <span data-ttu-id="0ebb9-124">如有必要，它退出故障，通过调用<xref:System.ServiceProcess.ServiceProcessInstaller.Rollback%2A>(或<xref:System.ServiceProcess.ServiceInstaller.Rollback%2A?displayProperty=nameWithType>) 上所有以前安装的组件。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-124">It backs out failures, if necessary, by calling <xref:System.ServiceProcess.ServiceProcessInstaller.Rollback%2A> (or <xref:System.ServiceProcess.ServiceInstaller.Rollback%2A?displayProperty=nameWithType>) on all previously installed components.</span></span>  
  
 <span data-ttu-id="0ebb9-125">安装实用工具调用<xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A>删除的对象。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-125">The installation utility calls <xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A> to remove the object.</span></span>  
  
 <span data-ttu-id="0ebb9-126">应用程序的安装例程维护自动有关组件已安装，使用项目安装程序的信息<xref:System.Configuration.Install.Installer.Context%2A?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-126">An application's install routine maintains information automatically about the components already installed, using the project installer's <xref:System.Configuration.Install.Installer.Context%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="0ebb9-127">此状态信息将持续更新作为<xref:System.ServiceProcess.ServiceProcessInstaller>实例和每个<xref:System.ServiceProcess.ServiceInstaller>由实用工具安装实例。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-127">This state information is continuously updated as the <xref:System.ServiceProcess.ServiceProcessInstaller> instance, and each <xref:System.ServiceProcess.ServiceInstaller> instance is installed by the utility.</span></span> <span data-ttu-id="0ebb9-128">它是通常情况下不必为你的代码来显式修改状态信息。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-128">It is usually unnecessary for your code to modify state information explicitly.</span></span>  
  
 <span data-ttu-id="0ebb9-129">当执行安装时，它会自动创建<xref:System.Diagnostics.EventLogInstaller>安装与关联的事件日志源<xref:System.ServiceProcess.ServiceBase>派生类。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-129">When the installation is performed, it automatically creates an <xref:System.Diagnostics.EventLogInstaller> to install the event log source associated with the <xref:System.ServiceProcess.ServiceBase> derived class.</span></span> <span data-ttu-id="0ebb9-130"><xref:System.Diagnostics.EventLog.Log%2A>此源的属性由设置<xref:System.ServiceProcess.ServiceInstaller.%23ctor%2A>到计算机的应用程序日志的构造函数。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-130">The <xref:System.Diagnostics.EventLog.Log%2A> property for this source is set by the <xref:System.ServiceProcess.ServiceInstaller.%23ctor%2A> constructor to the computer's Application log.</span></span> <span data-ttu-id="0ebb9-131">当你将设置<xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A>的<xref:System.ServiceProcess.ServiceInstaller>(应等于<xref:System.ServiceProcess.ServiceBase.ServiceName%2A?displayProperty=nameWithType>的服务)，则<xref:System.Diagnostics.EventLog.Source%2A>自动设置为相同的值。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-131">When you set the <xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A> of the <xref:System.ServiceProcess.ServiceInstaller> (which should be identical to the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A?displayProperty=nameWithType> of the service), the <xref:System.Diagnostics.EventLog.Source%2A> is automatically set to the same value.</span></span> <span data-ttu-id="0ebb9-132">在安装失败，源的安装以及以前安装的服务已回滚。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-132">In an installation failure, the source's installation is rolled-back along with previously installed services.</span></span>  
  
 <span data-ttu-id="0ebb9-133"><xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A>方法尝试在运行时将其停止服务。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-133">The <xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A> method tries to stop the service if it is running.</span></span> <span data-ttu-id="0ebb9-134">这是成功与否，<xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A>撤消所做的更改<xref:System.ServiceProcess.ServiceInstaller.Install%2A>。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-134">Whether this succeeds or not, <xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A> undoes the changes made by <xref:System.ServiceProcess.ServiceInstaller.Install%2A>.</span></span> <span data-ttu-id="0ebb9-135">如果为事件日志记录创建了新的源，源已删除。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-135">If a new source was created for event logging, the source is deleted.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="0ebb9-136">下面的示例创建一个项目安装程序，调用`MyProjectInstaller`，它继承自<xref:System.Configuration.Install.Installer>。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-136">The following example creates a project installer, called `MyProjectInstaller`, which inherits from <xref:System.Configuration.Install.Installer>.</span></span> <span data-ttu-id="0ebb9-137">假定没有服务可执行文件，包含两个服务，"Hello World 服务 1"和"Hello World 服务 2"。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-137">It is assumed there is a service executable that contains two services, "Hello-World Service 1" and "Hello-World Service 2".</span></span> <span data-ttu-id="0ebb9-138">中的构造函数`MyProjectInstaller`（这将由调用安装实用程序），<xref:System.ServiceProcess.ServiceInstaller>有关其中每个服务，并创建对象<xref:System.ServiceProcess.ServiceProcessInstaller>创建的可执行文件。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-138">Within the constructor for `MyProjectInstaller` (which would be called by the install utility), <xref:System.ServiceProcess.ServiceInstaller> objects are created for each of these services, and a <xref:System.ServiceProcess.ServiceProcessInstaller> is created for the executable.</span></span> <span data-ttu-id="0ebb9-139">为使安装实用工具来识别`MyProjectInstaller`作为有效的安装程序中，<xref:System.ComponentModel.RunInstallerAttribute>属性设置为`true`。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-139">For the install utility to recognize `MyProjectInstaller` as a valid installer, the <xref:System.ComponentModel.RunInstallerAttribute> attribute is set to `true`.</span></span>  
  
 <span data-ttu-id="0ebb9-140">可选属性设置的过程安装程序并服务安装程序安装程序添加到之前<xref:System.Configuration.Install.Installer.Installers%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-140">Optional properties are set on the process installer and the service installers before the installers are added to the <xref:System.Configuration.Install.Installer.Installers%2A> collection.</span></span> <span data-ttu-id="0ebb9-141">安装实用程序的访问时`MyProjectInstaller`，添加到对象<xref:System.Configuration.Install.Installer.Installers%2A>集合通过调用<xref:System.Configuration.Install.InstallerCollection.Add%2A?displayProperty=nameWithType>将反过来安装。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-141">When the install utility accesses `MyProjectInstaller`, the objects added to the <xref:System.Configuration.Install.Installer.Installers%2A> collection through a call to <xref:System.Configuration.Install.InstallerCollection.Add%2A?displayProperty=nameWithType> will be installed in turn.</span></span> <span data-ttu-id="0ebb9-142">在过程中，安装程序将维护指示已安装的对象，以便每个可以进行备份反过来，安装失败时的状态信息。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-142">During the process, the installer maintains state information indicating which objects have been installed, so each can be backed out in turn, if an installation failure occurs.</span></span>  
  
 <span data-ttu-id="0ebb9-143">通常情况下，你不会显式创建项目安装程序类的实例。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-143">Normally, you would not create an instance of your project installer class explicitly.</span></span> <span data-ttu-id="0ebb9-144">您可以创建它并添加<xref:System.ComponentModel.RunInstallerAttribute>属性的语法，但它是由安装实用工具来实际调用，并因此实例化类。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-144">You would create it and add the <xref:System.ComponentModel.RunInstallerAttribute> attribute to the syntax, but it is the install utility that actually calls, and therefore instantiates, the class.</span></span>  
  
 [!code-cpp[Classic ServiceInstaller Example#1](~/samples/snippets/cpp/VS_Snippets_CLR_Classic/classic ServiceInstaller Example/CPP/source.cpp#1)]
 [!code-csharp[Classic ServiceInstaller Example#1](~/samples/snippets/csharp/VS_Snippets_CLR_Classic/classic ServiceInstaller Example/CS/source.cs#1)]
 [!code-vb[Classic ServiceInstaller Example#1](~/samples/snippets/visualbasic/VS_Snippets_CLR_Classic/classic ServiceInstaller Example/VB/source.vb#1)]  
  
 ]]></format>
    </remarks>
    <altmember cref="P:System.ServiceProcess.ServiceBase.ServiceName" />
    <altmember cref="T:System.ServiceProcess.ServiceProcessInstaller" />
    <altmember cref="T:System.ServiceProcess.ServiceBase" />
    <altmember cref="P:System.ServiceProcess.ServiceBase.EventLog" />
  </Docs>
  <Members>
    <Member MemberName=".ctor">
      <MemberSignature Language="C#" Value="public ServiceInstaller ();" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig specialname rtspecialname instance void .ctor() cil managed" />
      <MemberSignature Language="DocId" Value="M:System.ServiceProcess.ServiceInstaller.#ctor" />
      <MemberSignature Language="VB.NET" Value="Public Sub New ()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; ServiceInstaller();" />
      <MemberType>Constructor</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.ServiceProcess</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Parameters />
      <Docs>
        <summary>
          <span data-ttu-id="0ebb9-145">Initializes a new instance of the <see cref="T:System.ServiceProcess.ServiceInstaller" /> class.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-145">Initializes a new instance of the <see cref="T:System.ServiceProcess.ServiceInstaller" /> class.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="0ebb9-146">若要安装服务，创建继承自项目安装程序类<xref:System.Configuration.Install.Installer>类，并将设置<xref:System.ComponentModel.RunInstallerAttribute>到类中的属性`true`。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-146">To install a service, create a project installer class that inherits from the <xref:System.Configuration.Install.Installer> class, and set the <xref:System.ComponentModel.RunInstallerAttribute> attribute on the class to `true`.</span></span> <span data-ttu-id="0ebb9-147">在项目中，创建一个<xref:System.ServiceProcess.ServiceProcessInstaller>每个服务应用程序，另一个实例<xref:System.ServiceProcess.ServiceInstaller>应用程序中每个服务的实例。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-147">Within your project, create one <xref:System.ServiceProcess.ServiceProcessInstaller> instance per service application, and one <xref:System.ServiceProcess.ServiceInstaller> instance for each service in the application.</span></span> <span data-ttu-id="0ebb9-148">在您项目安装程序类的构造函数，将设置为服务使用的安装属性<xref:System.ServiceProcess.ServiceProcessInstaller>和<xref:System.ServiceProcess.ServiceInstaller>实例，并将实例添加到<xref:System.Configuration.Install.Installer.Installers%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-148">Within your project installer class constructor, set the installation properties for the service using the <xref:System.ServiceProcess.ServiceProcessInstaller> and <xref:System.ServiceProcess.ServiceInstaller> instances, and add the instances to the <xref:System.Configuration.Install.Installer.Installers%2A> collection.</span></span>  
  
 <span data-ttu-id="0ebb9-149"><xref:System.ServiceProcess.ServiceInstaller.%23ctor%2A>构造函数自动生成事件日志源其<xref:System.Diagnostics.EventLog.Log%2A>属性设置为计算机的应用程序日志和<xref:System.Diagnostics.EventLogInstaller>。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-149">The <xref:System.ServiceProcess.ServiceInstaller.%23ctor%2A> constructor automatically generates an event log source whose <xref:System.Diagnostics.EventLog.Log%2A> property is set to the computer's Application log, and an <xref:System.Diagnostics.EventLogInstaller>.</span></span> <span data-ttu-id="0ebb9-150">当你将设置<xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A>的<xref:System.ServiceProcess.ServiceInstaller>，应等于<xref:System.ServiceProcess.ServiceBase.ServiceName%2A?displayProperty=nameWithType>的服务，<xref:System.Diagnostics.EventLog.Source%2A>的事件日志的属性自动设置为相同的值。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-150">When you set the <xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A> of the <xref:System.ServiceProcess.ServiceInstaller>, which should be identical to the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A?displayProperty=nameWithType> of the service, the <xref:System.Diagnostics.EventLog.Source%2A> property of the event log is automatically set to the same value.</span></span> <span data-ttu-id="0ebb9-151">安装失败的情况下，源会自动删除。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-151">The source is deleted automatically in the case of an installation failure.</span></span>  
  
 <span data-ttu-id="0ebb9-152"><xref:System.ServiceProcess.ServiceInstaller.%23ctor%2A>构造函数集<xref:System.ServiceProcess.ServiceInstaller.StartType%2A>属性`ServiceStartMode.Manual`指定用户启动服务。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-152">The <xref:System.ServiceProcess.ServiceInstaller.%23ctor%2A> constructor sets the <xref:System.ServiceProcess.ServiceInstaller.StartType%2A> property to `ServiceStartMode.Manual` to specify that a user start the service.</span></span> <span data-ttu-id="0ebb9-153">你可以重置将属性设为`ServiceStartMode.Automatic`指定当计算机重新启动时启动服务。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-153">You can reset the property to `ServiceStartMode.Automatic` to specify that the service start when the computer reboots.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="T:System.Diagnostics.EventLog" />
        <altmember cref="T:System.ServiceProcess.ServiceStartMode" />
      </Docs>
    </Member>
    <Member MemberName="CopyFromComponent">
      <MemberSignature Language="C#" Value="public override void CopyFromComponent (System.ComponentModel.IComponent component);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void CopyFromComponent(class System.ComponentModel.IComponent component) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.ServiceProcess.ServiceInstaller.CopyFromComponent(System.ComponentModel.IComponent)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub CopyFromComponent (component As IComponent)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void CopyFromComponent(System::ComponentModel::IComponent ^ component);" />
      <MemberSignature Language="F#" Value="override this.CopyFromComponent : System.ComponentModel.IComponent -&gt; unit" Usage="serviceInstaller.CopyFromComponent component" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.ServiceProcess</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="component" Type="System.ComponentModel.IComponent" />
      </Parameters>
      <Docs>
        <param name="component">
          <span data-ttu-id="0ebb9-154">The <see cref="T:System.ComponentModel.IComponent" /> from which to copy.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-154">The <see cref="T:System.ComponentModel.IComponent" /> from which to copy.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="0ebb9-155">Copies properties from an instance of <see cref="T:System.ServiceProcess.ServiceBase" /> to this installer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-155">Copies properties from an instance of <see cref="T:System.ServiceProcess.ServiceBase" /> to this installer.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="0ebb9-156">极少数情况下将在代码中调用此方法。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-156">This method will rarely be called within your code.</span></span> <span data-ttu-id="0ebb9-157"><xref:System.ServiceProcess.ServiceInstaller.CopyFromComponent%2A> 通常只能由设计器调用。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-157"><xref:System.ServiceProcess.ServiceInstaller.CopyFromComponent%2A> is usually called only by designers.</span></span>  
  
 <span data-ttu-id="0ebb9-158"><xref:System.ServiceProcess.ServiceInstaller.CopyFromComponent%2A> 将保存的服务名称`component`参数<xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A>的<xref:System.ServiceProcess.ServiceInstaller>实例。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-158"><xref:System.ServiceProcess.ServiceInstaller.CopyFromComponent%2A> saves the service name of the `component` parameter to the <xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A> of the <xref:System.ServiceProcess.ServiceInstaller> instance.</span></span> <span data-ttu-id="0ebb9-159">(因为参数必须是派生自的类的实例<xref:System.ServiceProcess.ServiceBase>，`component`要确保<xref:System.ServiceProcess.ServiceBase.ServiceName%2A?displayProperty=nameWithType>属性。)</span><span class="sxs-lookup"><span data-stu-id="0ebb9-159">(Because the parameter must be an instance of a class that derives from <xref:System.ServiceProcess.ServiceBase>, `component` is guaranteed to have a <xref:System.ServiceProcess.ServiceBase.ServiceName%2A?displayProperty=nameWithType> property.)</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="0ebb9-160">如果使用 Visual Studio 设计器，在当用户单击的设计时调用此方法`Add Installer`上指定此类为其安装程序的组件。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-160">If you are using the Visual Studio designer, this method is called at design time when the user clicks `Add Installer` on a component that specified this class as its installer.</span></span> <span data-ttu-id="0ebb9-161">安装程序不需要它可以从实时组件并将其存储在安装时使用的所有信息。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-161">The installer takes all information it can from the live component and stores it for use at install time.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="0ebb9-162">The component you are associating with this installer does not inherit from <see cref="T:System.ServiceProcess.ServiceBase" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-162">The component you are associating with this installer does not inherit from <see cref="T:System.ServiceProcess.ServiceBase" />.</span>
          </span>
        </exception>
        <altmember cref="M:System.ServiceProcess.ServiceProcessInstaller.CopyFromComponent(System.ComponentModel.IComponent)" />
      </Docs>
    </Member>
    <Member MemberName="DelayedAutoStart">
      <MemberSignature Language="C#" Value="public bool DelayedAutoStart { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance bool DelayedAutoStart" />
      <MemberSignature Language="DocId" Value="P:System.ServiceProcess.ServiceInstaller.DelayedAutoStart" />
      <MemberSignature Language="VB.NET" Value="Public Property DelayedAutoStart As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property bool DelayedAutoStart { bool get(); void set(bool value); };" />
      <MemberSignature Language="F#" Value="member this.DelayedAutoStart : bool with get, set" Usage="System.ServiceProcess.ServiceInstaller.DelayedAutoStart" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.ServiceProcess</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ServiceProcess.ServiceProcessDescription("ServiceInstallerDelayedAutoStart")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="0ebb9-163">Gets or sets a value that indicates whether the service should be delayed from starting until other automatically started services are running.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-163">Gets or sets a value that indicates whether the service should be delayed from starting until other automatically started services are running.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="0ebb9-164">
            <see langword="true" /> 对延迟自动启动的服务;否则为<see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-164">
              <see langword="true" /> to delay automatic start of the service; otherwise, <see langword="false" />.</span>
          </span>
          <span data-ttu-id="0ebb9-165">默认值为 <see langword="false" />。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-165">The default is <see langword="false" />.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="0ebb9-166"><xref:System.ServiceProcess.ServiceInstaller.DelayedAutoStart%2A>属性可以应用到任何服务，但它将被忽略，除非服务的启动模式是<xref:System.ServiceProcess.ServiceStartMode.Automatic>。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-166">The <xref:System.ServiceProcess.ServiceInstaller.DelayedAutoStart%2A> property can be applied to any service, but it is ignored unless the service's start mode is <xref:System.ServiceProcess.ServiceStartMode.Automatic>.</span></span> <span data-ttu-id="0ebb9-167">该设置将生效的下次重新启动系统。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-167">The setting takes effect the next time the system is restarted.</span></span> <span data-ttu-id="0ebb9-168">服务控制管理器不能保证服务特定的开始时间。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-168">The Service Control Manager does not guarantee a specific start time for the service.</span></span>  
  
 <span data-ttu-id="0ebb9-169">延迟的自动启动服务不能加载顺序组的成员，但它可以依赖于另一个自动启动服务。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-169">A delayed automatic start service cannot be a member of a load ordering group, but it can depend on another automatic start service.</span></span> <span data-ttu-id="0ebb9-170">如果应用程序调用延迟的自动启动服务，然后加载它，则调用将失败。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-170">If an application calls a delayed automatic start service before it is loaded, the call fails.</span></span>  
  
 <span data-ttu-id="0ebb9-171">不支持延迟的自动启动的操作系统，请将此属性设置不起。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-171">On operating systems that do not support delayed automatic start, setting this property has no effect.</span></span>  
  
 ]]></format>
        </remarks>
      </Docs>
    </Member>
    <Member MemberName="Description">
      <MemberSignature Language="C#" Value="public string Description { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string Description" />
      <MemberSignature Language="DocId" Value="P:System.ServiceProcess.ServiceInstaller.Description" />
      <MemberSignature Language="VB.NET" Value="Public Property Description As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ Description { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.Description : string with get, set" Usage="System.ServiceProcess.ServiceInstaller.Description" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.ServiceProcess</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.Runtime.InteropServices.ComVisible(false)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ServiceProcess.ServiceProcessDescription("ServiceInstallerDescription")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="0ebb9-172">Gets or sets the description for the service.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-172">Gets or sets the description for the service.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="0ebb9-173">服务的说明。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-173">The description of the service.</span>
          </span>
          <span data-ttu-id="0ebb9-174">默认值为空字符串("")。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-174">The default is an empty string ("").</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="0ebb9-175">使用<xref:System.ServiceProcess.ServiceInstaller.Description%2A>属性来描述向用户已安装的服务的用途。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-175">Use the <xref:System.ServiceProcess.ServiceInstaller.Description%2A> property to describe the purpose of the installed service to the user.</span></span> <span data-ttu-id="0ebb9-176">显示已安装的服务的详细信息的应用程序中，用户可以查看服务说明。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-176">The user can view the service description in applications that display details for installed services.</span></span>  
  
 <span data-ttu-id="0ebb9-177">例如，使用 Windows XP，你可以查看与服务控制命令行实用工具 (Sc.exe) 的服务说明或可以查看中的服务说明**服务**节点**计算机管理**控制台。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-177">For example, using Windows XP, you can view the service description with the Service Control command-line utility (Sc.exe) or you can view the service description within the **Services** node of the **Computer Management** console.</span></span>  
  
   
  
## Examples  
 <span data-ttu-id="0ebb9-178">下面的代码示例设置新的 Windows 服务应用程序的安装属性。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-178">The following code example sets the installation properties for a new Windows service application.</span></span> <span data-ttu-id="0ebb9-179">该示例设置的服务名称，以及显示名称和说明。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-179">The example sets the service name, along with the display name and description.</span></span> <span data-ttu-id="0ebb9-180">分配后该服务的安装属性，该示例将添加<xref:System.ServiceProcess.ServiceInstaller>对象传递给<xref:System.Configuration.Install.Installer.Installers%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-180">After assigning the installation properties for the service, the example adds the <xref:System.ServiceProcess.ServiceInstaller> object to the <xref:System.Configuration.Install.Installer.Installers%2A> collection.</span></span>  
  
 [!code-csharp[ServiceProcess_ServiceInstaller#3](~/samples/snippets/csharp/VS_Snippets_CLR/ServiceProcess_serviceinstaller/CS/simpleserviceinstaller.cs#3)]
 [!code-vb[ServiceProcess_ServiceInstaller#3](~/samples/snippets/visualbasic/VS_Snippets_CLR/ServiceProcess_serviceinstaller/VB/service1.vb#3)]  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.ServiceProcess.ServiceInstaller.ServiceName" />
        <altmember cref="P:System.ServiceProcess.ServiceInstaller.DisplayName" />
      </Docs>
    </Member>
    <Member MemberName="DisplayName">
      <MemberSignature Language="C#" Value="public string DisplayName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string DisplayName" />
      <MemberSignature Language="DocId" Value="P:System.ServiceProcess.ServiceInstaller.DisplayName" />
      <MemberSignature Language="VB.NET" Value="Public Property DisplayName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ DisplayName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.DisplayName : string with get, set" Usage="System.ServiceProcess.ServiceInstaller.DisplayName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.ServiceProcess</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ServiceProcess.ServiceProcessDescription("ServiceInstallerDisplayName")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="0ebb9-181">Indicates the friendly name that identifies the service to the user.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-181">Indicates the friendly name that identifies the service to the user.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="0ebb9-182">与交互式工具经常使用的服务关联的名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-182">The name associated with the service, used frequently for interactive tools.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="0ebb9-183"><xref:System.ServiceProcess.ServiceInstaller.DisplayName%2A>使用时，例如，服务控制管理器中以提供服务的用户可读的描述性名称。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-183">The <xref:System.ServiceProcess.ServiceInstaller.DisplayName%2A> is used, for example, in the Service Control Manager to provide a user-readable descriptive name for the service.</span></span> <span data-ttu-id="0ebb9-184"><xref:System.ServiceProcess.ServiceInstaller.DisplayName%2A>一个注册表值，但将绝不会用作注册表项。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-184">The <xref:System.ServiceProcess.ServiceInstaller.DisplayName%2A> is a registry value, but is never used as a registry key.</span></span> <span data-ttu-id="0ebb9-185">因此，限制<xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A>不适用于属性值。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-185">Therefore, restrictions on the <xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A> property value do not apply.</span></span> <span data-ttu-id="0ebb9-186"><xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A> 用作 HKEY_LOCAL_MACHINES\System\CurrentControlSet\Services 注册表项，因此，将被限制。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-186"><xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A> is used as the HKEY_LOCAL_MACHINES\System\CurrentControlSet\Services registry key, so it is restricted.</span></span>  
  
 <span data-ttu-id="0ebb9-187">显示名称永远不会由安装实用程序用来标识服务，因此如果没有选择，选择在限制的名称，因为没有为<xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A>属性。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-187">The display name is never used by the install utility to identify the service, so there are no restrictions on the choice of name, as there is for the <xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A> property.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.ServiceProcess.ServiceInstaller.ServiceName" />
        <altmember cref="P:System.ServiceProcess.ServiceInstaller.Description" />
      </Docs>
    </Member>
    <Member MemberName="Install">
      <MemberSignature Language="C#" Value="public override void Install (System.Collections.IDictionary stateSaver);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Install(class System.Collections.IDictionary stateSaver) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.ServiceProcess.ServiceInstaller.Install(System.Collections.IDictionary)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Install (stateSaver As IDictionary)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Install(System::Collections::IDictionary ^ stateSaver);" />
      <MemberSignature Language="F#" Value="override this.Install : System.Collections.IDictionary -&gt; unit" Usage="serviceInstaller.Install stateSaver" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.ServiceProcess</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="stateSaver" Type="System.Collections.IDictionary" />
      </Parameters>
      <Docs>
        <param name="stateSaver">
          <span data-ttu-id="0ebb9-188">An <see cref="T:System.Collections.IDictionary" /> that contains the context information associated with the installation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-188">An <see cref="T:System.Collections.IDictionary" /> that contains the context information associated with the installation.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="0ebb9-189">Installs the service by writing service application information to the registry.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-189">Installs the service by writing service application information to the registry.</span>
          </span>
          <span data-ttu-id="0ebb9-190">This method is meant to be used by installation tools, which process the appropriate methods automatically.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-190">This method is meant to be used by installation tools, which process the appropriate methods automatically.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="0ebb9-191">通常情况下，你将不调用对象方法<xref:System.ServiceProcess.ServiceInstaller>在代码中; 它们是通常只能由调用安装实用程序。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-191">Normally, you will not call the methods on <xref:System.ServiceProcess.ServiceInstaller> within your code; they are generally called only by the install utility.</span></span> <span data-ttu-id="0ebb9-192">安装实用程序将自动调用<xref:System.ServiceProcess.ServiceInstaller.Install%2A>在安装过程中的方法。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-192">The install utility automatically calls the <xref:System.ServiceProcess.ServiceInstaller.Install%2A> method during installation.</span></span> <span data-ttu-id="0ebb9-193">如有必要，它退出故障，通过调用<xref:System.ServiceProcess.ServiceInstaller.Rollback%2A>上生成异常的对象。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-193">It backs out failures, if necessary, by calling <xref:System.ServiceProcess.ServiceInstaller.Rollback%2A> on the object that generated the exception.</span></span>  
  
 <span data-ttu-id="0ebb9-194">应用程序的安装例程维护自动有关已安装，使用项目安装程序的组件的信息<xref:System.Configuration.Install.Installer.Context%2A?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-194">An application's install routine maintains information automatically about the components that were already installed, using the project installer's <xref:System.Configuration.Install.Installer.Context%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="0ebb9-195">此状态信息传递给<xref:System.ServiceProcess.ServiceInstaller.Install%2A>作为`stateSaver`参数，将持续更新作为<xref:System.ServiceProcess.ServiceProcessInstaller>实例和每个<xref:System.ServiceProcess.ServiceInstaller>由实用工具安装实例。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-195">This state information, passed into <xref:System.ServiceProcess.ServiceInstaller.Install%2A> as the `stateSaver` parameter, is continuously updated as the <xref:System.ServiceProcess.ServiceProcessInstaller> instance and each <xref:System.ServiceProcess.ServiceInstaller> instance is installed by the utility.</span></span> <span data-ttu-id="0ebb9-196">它是通常情况下不必为你的代码来显式修改此状态信息。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-196">It is usually unnecessary for your code to modify this state information explicitly.</span></span>  
  
 <span data-ttu-id="0ebb9-197"><xref:System.ServiceProcess.ServiceProcessInstaller>与项目安装类安装信息普遍适用于所有关联<xref:System.ServiceProcess.ServiceInstaller>项目中的实例。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-197">The <xref:System.ServiceProcess.ServiceProcessInstaller> associated with your project installation class installs information common to all <xref:System.ServiceProcess.ServiceInstaller> instances in the project.</span></span> <span data-ttu-id="0ebb9-198">如果此服务已将它隔离从安装项目中的其他服务的任何内容，此方法被安装该特定于服务的信息。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-198">If this service has anything that separates it from the other services in the installation project, that service-specific information is installed by this method.</span></span>  
  
 <span data-ttu-id="0ebb9-199">若要安装服务，创建继承自项目安装程序类<xref:System.Configuration.Install.Installer>类，并将设置<xref:System.ComponentModel.RunInstallerAttribute>到类中的属性`true`。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-199">To install a service, create a project installer class that inherits from the <xref:System.Configuration.Install.Installer> class, and set the <xref:System.ComponentModel.RunInstallerAttribute> attribute on the class to `true`.</span></span> <span data-ttu-id="0ebb9-200">在项目中，创建一个<xref:System.ServiceProcess.ServiceProcessInstaller>每个服务应用程序，另一个实例<xref:System.ServiceProcess.ServiceInstaller>应用程序中每个服务的实例。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-200">Within your project, create one <xref:System.ServiceProcess.ServiceProcessInstaller> instance per service application, and one <xref:System.ServiceProcess.ServiceInstaller> instance for each service in the application.</span></span> <span data-ttu-id="0ebb9-201">在您项目安装程序类的构造函数，将设置为服务使用的安装属性<xref:System.ServiceProcess.ServiceProcessInstaller>和<xref:System.ServiceProcess.ServiceInstaller>实例，并将实例添加到<xref:System.Configuration.Install.Installer.Installers%2A>集合。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-201">Within your project installer class constructor, set the installation properties for the service using the <xref:System.ServiceProcess.ServiceProcessInstaller> and <xref:System.ServiceProcess.ServiceInstaller> instances, and add the instances to the <xref:System.Configuration.Install.Installer.Installers%2A> collection.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="0ebb9-202">建议添加安装程序实例; 使用构造函数但是，如果你需要将添加到<xref:System.Configuration.Install.Installer.Installers%2A>中的集合<xref:System.ServiceProcess.ServiceInstaller.Install%2A>方法，请务必执行上述相同的元素添加到集合中<xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-202">It is recommended that you use the constructor for adding installer instances; however, if you need to add to the <xref:System.Configuration.Install.Installer.Installers%2A> collection in the <xref:System.ServiceProcess.ServiceInstaller.Install%2A> method, be sure to perform the same additions to the collection in the <xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A> method.</span></span>  
  
 <span data-ttu-id="0ebb9-203">为派生自的所有类<xref:System.Configuration.Install.Installer>类的状态<xref:System.Configuration.Install.Installer.Installers%2A>集合必须在相同<xref:System.ServiceProcess.ServiceInstaller.Install%2A>和<xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-203">For all classes deriving from the <xref:System.Configuration.Install.Installer> class, the state of the <xref:System.Configuration.Install.Installer.Installers%2A> collection must be the same in the <xref:System.ServiceProcess.ServiceInstaller.Install%2A> and <xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A> methods.</span></span> <span data-ttu-id="0ebb9-204">但是，您可以避免在对集合进行维护<xref:System.ServiceProcess.ServiceInstaller.Install%2A>和<xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A>方法如果你安装程序将实例添加到<xref:System.Configuration.Install.Installer.Installers%2A>在自定义安装程序类构造函数的集合。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-204">However, you can avoid the maintenance of the collection across the <xref:System.ServiceProcess.ServiceInstaller.Install%2A> and <xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A> methods if you add installer instances to the <xref:System.Configuration.Install.Installer.Installers%2A> collection in your custom installer class constructor.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.InvalidOperationException">
          <span data-ttu-id="0ebb9-205">The installation does not contain a <see cref="T:System.ServiceProcess.ServiceProcessInstaller" /> for the executable.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-205">The installation does not contain a <see cref="T:System.ServiceProcess.ServiceProcessInstaller" /> for the executable.</span>
          </span>
          <span data-ttu-id="0ebb9-206">-or-  The file name for the assembly is <see langword="null" /> or an empty string.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-206">-or-  The file name for the assembly is <see langword="null" /> or an empty string.</span>
          </span>
          <span data-ttu-id="0ebb9-207">-or-  The service name is invalid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-207">-or-  The service name is invalid.</span>
          </span>
          <span data-ttu-id="0ebb9-208">-or-  The Service Control Manager could not be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-208">-or-  The Service Control Manager could not be opened.</span>
          </span>
        </exception>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="0ebb9-209">The display name for the service is more than 255 characters in length.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-209">The display name for the service is more than 255 characters in length.</span>
          </span>
        </exception>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="0ebb9-210">The system could not generate a handle to the service.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-210">The system could not generate a handle to the service.</span>
          </span>
          <span data-ttu-id="0ebb9-211">-or-  A service with that name is already installed.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-211">-or-  A service with that name is already installed.</span>
          </span>
        </exception>
        <altmember cref="T:System.ServiceProcess.ServiceProcessInstaller" />
        <altmember cref="M:System.ServiceProcess.ServiceInstaller.Rollback(System.Collections.IDictionary)" />
        <altmember cref="M:System.Configuration.Install.Installer.Commit(System.Collections.IDictionary)" />
        <altmember cref="M:System.ServiceProcess.ServiceInstaller.Uninstall(System.Collections.IDictionary)" />
        <altmember cref="T:System.Diagnostics.EventLogInstaller" />
        <altmember cref="M:System.Diagnostics.EventLogInstaller.#ctor" />
      </Docs>
    </Member>
    <Member MemberName="IsEquivalentInstaller">
      <MemberSignature Language="C#" Value="public override bool IsEquivalentInstaller (System.Configuration.Install.ComponentInstaller otherInstaller);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance bool IsEquivalentInstaller(class System.Configuration.Install.ComponentInstaller otherInstaller) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.ServiceProcess.ServiceInstaller.IsEquivalentInstaller(System.Configuration.Install.ComponentInstaller)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Function IsEquivalentInstaller (otherInstaller As ComponentInstaller) As Boolean" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override bool IsEquivalentInstaller(System::Configuration::Install::ComponentInstaller ^ otherInstaller);" />
      <MemberSignature Language="F#" Value="override this.IsEquivalentInstaller : System.Configuration.Install.ComponentInstaller -&gt; bool" Usage="serviceInstaller.IsEquivalentInstaller otherInstaller" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.ServiceProcess</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Boolean</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="otherInstaller" Type="System.Configuration.Install.ComponentInstaller" />
      </Parameters>
      <Docs>
        <param name="otherInstaller">
          <span data-ttu-id="0ebb9-212">A <see cref="T:System.Configuration.Install.ComponentInstaller" /> to which you are comparing the current installer.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-212">A <see cref="T:System.Configuration.Install.ComponentInstaller" /> to which you are comparing the current installer.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="0ebb9-213">Indicates whether two installers would install the same service.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-213">Indicates whether two installers would install the same service.</span>
          </span>
        </summary>
        <returns>
          <span data-ttu-id="0ebb9-214">
            <see langword="true" /> if calling <see cref="M:System.ServiceProcess.ServiceInstaller.Install(System.Collections.IDictionary)" /> on both of these installers would result in installing the same service; otherwise, <see langword="false" />.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-214">
              <see langword="true" /> if calling <see cref="M:System.ServiceProcess.ServiceInstaller.Install(System.Collections.IDictionary)" /> on both of these installers would result in installing the same service; otherwise, <see langword="false" />.</span>
          </span>
        </returns>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="0ebb9-215"><xref:System.ServiceProcess.ServiceInstaller.IsEquivalentInstaller%2A> 例如，指示两个安装程序是否将安装在相同的用户帐户下相同的服务。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-215"><xref:System.ServiceProcess.ServiceInstaller.IsEquivalentInstaller%2A> indicates, for example, whether two installers would install the same service under the same user account.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.ServiceProcess.ServiceInstaller.CopyFromComponent(System.ComponentModel.IComponent)" />
        <altmember cref="T:System.Configuration.Install.ComponentInstaller" />
      </Docs>
    </Member>
    <Member MemberName="Rollback">
      <MemberSignature Language="C#" Value="public override void Rollback (System.Collections.IDictionary savedState);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Rollback(class System.Collections.IDictionary savedState) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.ServiceProcess.ServiceInstaller.Rollback(System.Collections.IDictionary)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Rollback (savedState As IDictionary)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Rollback(System::Collections::IDictionary ^ savedState);" />
      <MemberSignature Language="F#" Value="override this.Rollback : System.Collections.IDictionary -&gt; unit" Usage="serviceInstaller.Rollback savedState" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.ServiceProcess</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="savedState" Type="System.Collections.IDictionary" />
      </Parameters>
      <Docs>
        <param name="savedState">
          <span data-ttu-id="0ebb9-216">An <see cref="T:System.Collections.IDictionary" /> that contains the context information associated with the installation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-216">An <see cref="T:System.Collections.IDictionary" /> that contains the context information associated with the installation.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="0ebb9-217">Rolls back service application information written to the registry by the installation procedure.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-217">Rolls back service application information written to the registry by the installation procedure.</span>
          </span>
          <span data-ttu-id="0ebb9-218">This method is meant to be used by installation tools, which process the appropriate methods automatically.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-218">This method is meant to be used by installation tools, which process the appropriate methods automatically.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="0ebb9-219">通常情况下，你将不调用对象方法<xref:System.ServiceProcess.ServiceInstaller>在代码中; 它们是通常只能由调用安装实用程序。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-219">Normally, you will not call the methods on <xref:System.ServiceProcess.ServiceInstaller> within your code; they are generally called only by the install utility.</span></span> <span data-ttu-id="0ebb9-220">安装实用程序将自动调用<xref:System.ServiceProcess.ServiceInstaller.Install%2A>在安装过程中的方法。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-220">The install utility automatically calls the <xref:System.ServiceProcess.ServiceInstaller.Install%2A> method during the installation process.</span></span> <span data-ttu-id="0ebb9-221">如有必要，它退出故障，通过调用<xref:System.ServiceProcess.ServiceInstaller.Rollback%2A>上生成异常的对象。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-221">It backs out failures, if necessary, by calling <xref:System.ServiceProcess.ServiceInstaller.Rollback%2A> on the object that generated the exception.</span></span>  
  
 <span data-ttu-id="0ebb9-222">应用程序的安装例程维护自动有关组件已安装，使用项目安装程序的信息<xref:System.Configuration.Install.Installer.Context%2A?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-222">An application's install routine maintains information automatically about the components already installed, using the project installer's <xref:System.Configuration.Install.Installer.Context%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="0ebb9-223">此状态信息传递给<xref:System.ServiceProcess.ServiceInstaller.Rollback%2A>作为`savedState`参数，将持续更新作为<xref:System.ServiceProcess.ServiceProcessInstaller>实例和每个<xref:System.ServiceProcess.ServiceInstaller>由实用工具安装实例。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-223">This state information, passed into <xref:System.ServiceProcess.ServiceInstaller.Rollback%2A> as the `savedState` parameter, is continuously updated as the <xref:System.ServiceProcess.ServiceProcessInstaller> instance and each <xref:System.ServiceProcess.ServiceInstaller> instance is installed by the utility.</span></span> <span data-ttu-id="0ebb9-224">它是通常情况下不必为你的代码来显式修改此状态信息。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-224">It is usually unnecessary for your code to modify this state information explicitly.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="M:System.ServiceProcess.ServiceProcessInstaller.Rollback(System.Collections.IDictionary)" />
        <altmember cref="M:System.ServiceProcess.ServiceInstaller.Install(System.Collections.IDictionary)" />
        <altmember cref="M:System.Configuration.Install.Installer.Commit(System.Collections.IDictionary)" />
        <altmember cref="M:System.ServiceProcess.ServiceInstaller.Uninstall(System.Collections.IDictionary)" />
      </Docs>
    </Member>
    <Member MemberName="ServiceName">
      <MemberSignature Language="C#" Value="public string ServiceName { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string ServiceName" />
      <MemberSignature Language="DocId" Value="P:System.ServiceProcess.ServiceInstaller.ServiceName" />
      <MemberSignature Language="VB.NET" Value="Public Property ServiceName As String" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::String ^ ServiceName { System::String ^ get(); void set(System::String ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ServiceName : string with get, set" Usage="System.ServiceProcess.ServiceInstaller.ServiceName" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.ServiceProcess</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue("")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ComponentModel.TypeConverter("System.Diagnostics.Design.StringValueConverter, System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a")</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ServiceProcess.ServiceProcessDescription("ServiceInstallerServiceName")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="0ebb9-225">Indicates the name used by the system to identify this service.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-225">Indicates the name used by the system to identify this service.</span>
          </span>
          <span data-ttu-id="0ebb9-226">This property must be identical to the <see cref="P:System.ServiceProcess.ServiceBase.ServiceName" /> of the service you want to install.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-226">This property must be identical to the <see cref="P:System.ServiceProcess.ServiceBase.ServiceName" /> of the service you want to install.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="0ebb9-227">要安装的服务名称。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-227">The name of the service to be installed.</span>
          </span>
          <span data-ttu-id="0ebb9-228">在尝试安装服务安装实用程序之前，必须设置此值。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-228">This value must be set before the install utility attempts to install the service.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="0ebb9-229">至关重要的<xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A>能与<xref:System.ServiceProcess.ServiceBase.ServiceName%2A?displayProperty=nameWithType>类派生自的<xref:System.ServiceProcess.ServiceBase>。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-229">It is crucial that the <xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A> be identical to the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A?displayProperty=nameWithType> of the class you derived from <xref:System.ServiceProcess.ServiceBase>.</span></span> <span data-ttu-id="0ebb9-230">通常情况下，值<xref:System.ServiceProcess.ServiceBase.ServiceName%2A?displayProperty=nameWithType>在服务应用程序的可执行文件的 main （） 函数中设置服务的属性。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-230">Normally, the value of the <xref:System.ServiceProcess.ServiceBase.ServiceName%2A?displayProperty=nameWithType> property for the service is set within the Main() function of the service application's executable.</span></span> <span data-ttu-id="0ebb9-231">服务控制管理器使用<xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A?displayProperty=nameWithType>属性可以查找服务在服务内此可执行文件。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-231">The Service Control Manager uses the <xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A?displayProperty=nameWithType> property to locate the service within this executable.</span></span>  
  
 <span data-ttu-id="0ebb9-232">当你将设置<xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A>服务安装程序，<xref:System.Diagnostics.EventLog.Source%2A>相关联的事件日志设置为相同的值。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-232">When you set the <xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A> of the service installer, the <xref:System.Diagnostics.EventLog.Source%2A> of the associated event log is set to the same value.</span></span> <span data-ttu-id="0ebb9-233">这允许服务自动登录到计算机上的应用程序日志服务命令 （例如启动和停止） 调用。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-233">This allows the service to automatically log service commands (such as Start and Stop) calls to the Application log on the computer.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="0ebb9-234">如果按相同名称的源已存在的计算机上，但日志而不是应用程序日志中，将引发异常。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-234">If a source by the same name already exists on the computer, but in a log other than the Application log, an exception will be thrown.</span></span> <span data-ttu-id="0ebb9-235">如果源存在，并且与应用程序日志关联，该源可用于报告命令调用服务，并不会引发异常。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-235">If the source exists and is associated with the Application log, that source is used to report command calls to the service, and no exception is thrown.</span></span>  
  
 <span data-ttu-id="0ebb9-236"><xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A>不能为`null`或长度为零。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-236">The <xref:System.ServiceProcess.ServiceInstaller.ServiceName%2A> cannot be `null` or have zero length.</span></span> <span data-ttu-id="0ebb9-237">其最大大小为 256 个字符。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-237">Its maximum size is 256 characters.</span></span> <span data-ttu-id="0ebb9-238">它还不能包含向前或向后斜杠 / 或\\，或来自 ASCII 字符字符设置为，值小于十进制值 32。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-238">It also cannot contain forward or backward slashes, '/' or '\\', or characters from the ASCII character set with value less than decimal value 32.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ArgumentException">
          <span data-ttu-id="0ebb9-239">The <see cref="P:System.ServiceProcess.ServiceInstaller.ServiceName" /> property is invalid.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-239">The <see cref="P:System.ServiceProcess.ServiceInstaller.ServiceName" /> property is invalid.</span>
          </span>
        </exception>
        <altmember cref="P:System.ServiceProcess.ServiceBase.ServiceName" />
        <altmember cref="P:System.ServiceProcess.ServiceInstaller.DisplayName" />
      </Docs>
    </Member>
    <Member MemberName="ServicesDependedOn">
      <MemberSignature Language="C#" Value="public string[] ServicesDependedOn { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance string[] ServicesDependedOn" />
      <MemberSignature Language="DocId" Value="P:System.ServiceProcess.ServiceInstaller.ServicesDependedOn" />
      <MemberSignature Language="VB.NET" Value="Public Property ServicesDependedOn As String()" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property cli::array &lt;System::String ^&gt; ^ ServicesDependedOn { cli::array &lt;System::String ^&gt; ^ get(); void set(cli::array &lt;System::String ^&gt; ^ value); };" />
      <MemberSignature Language="F#" Value="member this.ServicesDependedOn : string[] with get, set" Usage="System.ServiceProcess.ServiceInstaller.ServicesDependedOn" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.ServiceProcess</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ServiceProcess.ServiceProcessDescription("ServiceInstallerServicesDependedOn")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.String[]</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="0ebb9-240">Indicates the services that must be running for this service to run.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-240">Indicates the services that must be running for this service to run.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="0ebb9-241">此安装程序与关联的服务可以运行之前必须运行的服务数组。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-241">An array of services that must be running before the service associated with this installer can run.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="0ebb9-242">服务可能需要其他服务正在运行，才能启动。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-242">A service can require other services to be running before it can start.</span></span> <span data-ttu-id="0ebb9-243">此属性中的信息写入到注册表中的键。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-243">The information from this property is written to a key in the registry.</span></span> <span data-ttu-id="0ebb9-244">当用户 （或在自动启动系统） 尝试运行该服务时，服务控制管理器 (SCM) 验证每个数组中的服务已经启动。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-244">When the user (or the system, in the case of automatic startup) tries to run the service, the Service Control Manager (SCM) verifies that each of the services in the array has already been started.</span></span>  
  
 <span data-ttu-id="0ebb9-245">如果数组中的任何服务未然后运行，则 SCM 将尝试启动它们。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-245">If any service in the array is not running then, the SCM tries to start them.</span></span> <span data-ttu-id="0ebb9-246">这包括服务与`Manual` <xref:System.ServiceProcess.ServiceInstaller.StartType%2A>。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-246">This includes services with `Manual`<xref:System.ServiceProcess.ServiceInstaller.StartType%2A>.</span></span>  
  
 <span data-ttu-id="0ebb9-247">如果此服务所依赖的任何服务启动失败时，将无法启动此服务。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-247">If any service upon which this service depends fails to start, this service will not start.</span></span> <span data-ttu-id="0ebb9-248">如果系统未启动，因为没有在系统级别来检测该处理异常，不会引发异常。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-248">An exception is not thrown if the system is not started because there is no exception handling at the system level to detect this.</span></span> <span data-ttu-id="0ebb9-249">决定如何处理服务启动失败，并在你的代码中实现这。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-249">Decide how to handle service start failures and implement this in your code.</span></span> <span data-ttu-id="0ebb9-250">通常情况下，对话框向用户显示在启动时如果无法启动服务。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-250">Typically, a dialog appears to the user at startup if a service fails to start.</span></span>  
  
 <span data-ttu-id="0ebb9-251">如果服务未启动，会在应用程序事件日志中写入一个条目。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-251">If the service does not start, an entry is written to the Application event log.</span></span>  
  
 <span data-ttu-id="0ebb9-252">此服务所依赖的服务不需要处于同一可执行文件。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-252">The services upon which this service depends do not need to be in the same executable.</span></span>  
  
 ]]></format>
        </remarks>
        <altmember cref="P:System.ServiceProcess.ServiceInstaller.StartType" />
      </Docs>
    </Member>
    <Member MemberName="StartType">
      <MemberSignature Language="C#" Value="public System.ServiceProcess.ServiceStartMode StartType { get; set; }" />
      <MemberSignature Language="ILAsm" Value=".property instance valuetype System.ServiceProcess.ServiceStartMode StartType" />
      <MemberSignature Language="DocId" Value="P:System.ServiceProcess.ServiceInstaller.StartType" />
      <MemberSignature Language="VB.NET" Value="Public Property StartType As ServiceStartMode" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; property System::ServiceProcess::ServiceStartMode StartType { System::ServiceProcess::ServiceStartMode get(); void set(System::ServiceProcess::ServiceStartMode value); };" />
      <MemberSignature Language="F#" Value="member this.StartType : System.ServiceProcess.ServiceStartMode with get, set" Usage="System.ServiceProcess.ServiceInstaller.StartType" />
      <MemberType>Property</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.ServiceProcess</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <Attributes>
        <Attribute>
          <AttributeName>System.ComponentModel.DefaultValue(Mono.Cecil.CustomAttributeArgument)</AttributeName>
        </Attribute>
        <Attribute>
          <AttributeName>System.ServiceProcess.ServiceProcessDescription("ServiceInstallerStartType")</AttributeName>
        </Attribute>
      </Attributes>
      <ReturnValue>
        <ReturnType>System.ServiceProcess.ServiceStartMode</ReturnType>
      </ReturnValue>
      <Docs>
        <summary>
          <span data-ttu-id="0ebb9-253">Indicates how and when this service is started.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-253">Indicates how and when this service is started.</span>
          </span>
        </summary>
        <value>
          <span data-ttu-id="0ebb9-254">A<see cref="T:System.ServiceProcess.ServiceStartMode" />表示该服务已启动的方式。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-254">A <see cref="T:System.ServiceProcess.ServiceStartMode" /> that represents the way the service is started.</span>
          </span>
          <span data-ttu-id="0ebb9-255">默认值是<see langword="Manual" />，它指定，该服务将不自动重新启动后。</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-255">The default is <see langword="Manual" />, which specifies that the service will not automatically start after reboot.</span>
          </span>
        </value>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="0ebb9-256">设置<xref:System.ServiceProcess.ServiceInstaller.StartType%2A>指定，在重新启动后自动启动该服务或用户必须手动启动该服务。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-256">Set the <xref:System.ServiceProcess.ServiceInstaller.StartType%2A> to specify either that the service be started automatically after reboot or that a user must manually start the service.</span></span> <span data-ttu-id="0ebb9-257">服务也被禁用，指定，不能启动，手动或以编程方式，直至启用。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-257">A service can also be disabled, specifying that it cannot be started, either manually or programmatically, until it is enabled.</span></span>  
  
 <span data-ttu-id="0ebb9-258">无法更改<xref:System.ServiceProcess.ServiceInstaller>安装后的属性值。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-258">You cannot change <xref:System.ServiceProcess.ServiceInstaller> property values after installation.</span></span> <span data-ttu-id="0ebb9-259">若要更改<xref:System.ServiceProcess.ServiceInstaller.StartType%2A>，你必须卸载并重新安装你的服务，或者手动更改使用服务控制管理器的设置。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-259">To change the <xref:System.ServiceProcess.ServiceInstaller.StartType%2A>, you either have to uninstall and reinstall your service, or manually change the setting using the Service Control Manager.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.InvalidEnumArgumentException">
          <span data-ttu-id="0ebb9-260">The start mode is not a value of the <see cref="T:System.ServiceProcess.ServiceStartMode" /> enumeration.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-260">The start mode is not a value of the <see cref="T:System.ServiceProcess.ServiceStartMode" /> enumeration.</span>
          </span>
        </exception>
        <altmember cref="P:System.ServiceProcess.ServiceProcessInstaller.Account" />
      </Docs>
    </Member>
    <Member MemberName="Uninstall">
      <MemberSignature Language="C#" Value="public override void Uninstall (System.Collections.IDictionary savedState);" />
      <MemberSignature Language="ILAsm" Value=".method public hidebysig virtual instance void Uninstall(class System.Collections.IDictionary savedState) cil managed" />
      <MemberSignature Language="DocId" Value="M:System.ServiceProcess.ServiceInstaller.Uninstall(System.Collections.IDictionary)" />
      <MemberSignature Language="VB.NET" Value="Public Overrides Sub Uninstall (savedState As IDictionary)" />
      <MemberSignature Language="C++ CLI" Value="public:&#xA; override void Uninstall(System::Collections::IDictionary ^ savedState);" />
      <MemberSignature Language="F#" Value="override this.Uninstall : System.Collections.IDictionary -&gt; unit" Usage="serviceInstaller.Uninstall savedState" />
      <MemberType>Method</MemberType>
      <AssemblyInfo>
        <AssemblyName>System.ServiceProcess</AssemblyName>
        <AssemblyVersion>4.0.0.0</AssemblyVersion>
      </AssemblyInfo>
      <ReturnValue>
        <ReturnType>System.Void</ReturnType>
      </ReturnValue>
      <Parameters>
        <Parameter Name="savedState" Type="System.Collections.IDictionary" />
      </Parameters>
      <Docs>
        <param name="savedState">
          <span data-ttu-id="0ebb9-261">An <see cref="T:System.Collections.IDictionary" /> that contains the context information associated with the installation.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-261">An <see cref="T:System.Collections.IDictionary" /> that contains the context information associated with the installation.</span>
          </span>
        </param>
        <summary>
          <span data-ttu-id="0ebb9-262">Uninstalls the service by removing information about it from the registry.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-262">Uninstalls the service by removing information about it from the registry.</span>
          </span>
        </summary>
        <remarks>
          <format type="text/markdown"><![CDATA[  
  
## Remarks  
 <span data-ttu-id="0ebb9-263">卸载在卸载之前停止该服务的第一个尝试。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-263">Uninstall first attempts to stop the service before uninstalling it.</span></span> <span data-ttu-id="0ebb9-264">如果不停止该服务，不捕获到异常，并方法继续删除服务。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-264">If the service cannot be stopped, no exception is caught, and the method continues with the removal of the service.</span></span>  
  
 <span data-ttu-id="0ebb9-265">通常情况下，你将不调用对象方法<xref:System.ServiceProcess.ServiceInstaller>在代码中; 它们是通常只能由调用安装实用程序。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-265">Normally, you will not call the methods on <xref:System.ServiceProcess.ServiceInstaller> within your code; they are generally called only by the install utility.</span></span> <span data-ttu-id="0ebb9-266">InstallUtil 用于卸载服务，以及安装它们。卸载命令行调用中将一个交换机。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-266">InstallUtil is used to uninstall services as well as install them; uninstalling takes a switch in the command line call.</span></span>  
  
 <span data-ttu-id="0ebb9-267">应用程序的卸载例程维护自动有关组件的信息正在卸载，使用项目安装程序的<xref:System.Configuration.Install.Installer.Context%2A?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-267">An application's uninstall routine maintains information automatically about the components being uninstalled, using the project installer's <xref:System.Configuration.Install.Installer.Context%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="0ebb9-268">此状态信息传递给<xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A>作为`savedState`参数，将持续更新作为<xref:System.ServiceProcess.ServiceProcessInstaller>实例和每个<xref:System.ServiceProcess.ServiceInstaller>由实用工具安装实例。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-268">This state information, passed into <xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A> as the `savedState` parameter, is continuously updated as the <xref:System.ServiceProcess.ServiceProcessInstaller> instance and each <xref:System.ServiceProcess.ServiceInstaller> instance is installed by the utility.</span></span> <span data-ttu-id="0ebb9-269">它是通常情况下不必为你的代码来显式修改此状态信息。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-269">It is usually unnecessary for your code to modify this state information explicitly.</span></span>  
  
 <span data-ttu-id="0ebb9-270">为派生自的所有类<xref:System.Configuration.Install.Installer>类的状态<xref:System.Configuration.Install.Installer.Installers%2A>集合必须在相同<xref:System.ServiceProcess.ServiceInstaller.Install%2A>和<xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-270">For all classes deriving from the <xref:System.Configuration.Install.Installer> class, the state of the <xref:System.Configuration.Install.Installer.Installers%2A> collection must be the same in the <xref:System.ServiceProcess.ServiceInstaller.Install%2A> and <xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A> methods.</span></span> <span data-ttu-id="0ebb9-271">但是，您可以避免在对集合进行维护<xref:System.ServiceProcess.ServiceInstaller.Install%2A>和<xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A>方法如果你安装程序将实例添加到<xref:System.Configuration.Install.Installer.Installers%2A>在自定义安装程序类构造函数的集合。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-271">However, you can avoid the maintenance of the collection across the <xref:System.ServiceProcess.ServiceInstaller.Install%2A> and <xref:System.ServiceProcess.ServiceInstaller.Uninstall%2A> methods if you add installer instances to the <xref:System.Configuration.Install.Installer.Installers%2A> collection in your custom installer class constructor.</span></span>  
  
 <span data-ttu-id="0ebb9-272">因此，如果一个服务卸载失败，这不会影响内的其他服务 （通常是相同的安装项目） 正在卸载，没有用于卸载，回滚机制。</span><span class="sxs-lookup"><span data-stu-id="0ebb9-272">There is no rollback mechanism for uninstalling, so if one service fails to uninstall, this does not affect the other services (usually within the same installation project) being uninstalled.</span></span>  
  
 ]]></format>
        </remarks>
        <exception cref="T:System.ComponentModel.Win32Exception">
          <span data-ttu-id="0ebb9-273">The Service Control Manager could not be opened.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-273">The Service Control Manager could not be opened.</span>
          </span>
          <span data-ttu-id="0ebb9-274">-or-  The system could not get a handle to the service.</span>
          <span class="sxs-lookup">
            <span data-stu-id="0ebb9-274">-or-  The system could not get a handle to the service.</span>
          </span>
        </exception>
        <altmember cref="M:System.ServiceProcess.ServiceInstaller.Install(System.Collections.IDictionary)" />
      </Docs>
    </Member>
  </Members>
</Type>